#!/usr/bin/env python3
import csv, os
from io import TextIOWrapper
from os.path import join, dirname, abspath
from urllib.request import urlopen

SOURCE_URL = "http://fsl.cs.illinois.edu/spec-eval/bugreports.csv"

def read_csv(url):
    stream = urlopen(url)
    reader = csv.reader(TextIOWrapper(stream))
    return list(reader)

def get_rows_with_accepted_pull_requests_from(source):
    accepted_rows = []

    for row in source:
        _, _, _, _, status = row

        if status in ['Accepted']:
            accepted_rows.append(row)
        elif status in ['Rejected', 'Pending ', 'Already fixed']:
            pass
        else:
            raise ValueError("Unknown status: {}".format(status))

    return accepted_rows
        

source = read_csv(SOURCE_URL)
accepted = get_rows_with_accepted_pull_requests_from(source)

for row in accepted:
    print(row) 
