#!/usr/bin/env python3

SOURCE_URL = "http://fsl.cs.illinois.edu/spec-eval/bugreports.csv"

def load_source(url):
    import urllib.request
    file_path, headers = urllib.request.urlretrieve(url)
    return file_path

def read_csv(file_path):
    lines = []
    import csv
    with open(file_path, newline='') as file_:
        reader = csv.reader(file_)
        for row in reader:
            lines.append(row)
    return lines

def get_rows_with_accepted_pull_requests_from(source):
    accepted_rows = []

    for row in source:
        _, _, _, _, status = row

        if status in ['Accepted']:
            accepted_rows.append(row)
        elif status in ['Rejected', 'Pending ', 'Already fixed']:
            pass
        else:
            raise ValueError("Unknown status: {}".format(status))

    return accepted_rows
        

source = read_csv(load_source(SOURCE_URL))
accepted = get_rows_with_accepted_pull_requests_from(source)

for row in accepted:
    print(row) 
